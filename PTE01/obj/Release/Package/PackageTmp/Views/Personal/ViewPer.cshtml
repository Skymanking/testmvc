@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_Theme3.cshtml";
    string sxuong = ""; string scapbac = "";
    string maHDLD = DateTime.Now.DayOfYear + "-" + DateTime.Now.Year + "-HDLD-";
   string sGroupID = ViewBag.GroupID;
   string sCMNDPlace = ViewBag.CMNDPlace;
   string sAcademicLevel = ViewBag.AcademicLevel;
   string sCity = ViewBag.City;
   string sIDPosition = ViewBag.IDPosition;
    List<Model.EF.HDLD> listHDLD = ViewBag.listHDLD;
    List<Model.EF.PersonalTool> listTool = ViewBag.listTool;
    List<Model.View.TrainingView1> listTraining = ViewBag.listTraining;
    Model.EF.Personal Model = ViewBag.item;
    List<SelectListItem> phanxuong = new List<SelectListItem>();
    phanxuong.Add(new SelectListItem
         {
             Text = "Xưởng 1",
             Value = "X1",
             Selected = true
         });

    phanxuong.Add(new SelectListItem
         {
             Text = "Xưởng 2",
             Value = "X2",

         });
    phanxuong.Add(new SelectListItem
    {
        Text = "Xưởng 3",
        Value = "X3",
    });
    
    List<SelectListItem> capbac = new List<SelectListItem>();
    List<SelectListItem> listVT = new List<SelectListItem>();
    capbac.Add(new SelectListItem
         {
             Text = "Chưa cập nhật thông tin",
             Value = "99",
             Selected = true
         });

    capbac.Add(new SelectListItem
         {
             Text = "Nhóm 1 - Giám đốc/Phó Giám đốc",
             Value = "1",

         });
    capbac.Add(new SelectListItem
    {
        Text = "Nhóm 2 - Kế toán trưởng/Chuyên gia cấp cao",
        Value = "2",
    });
    capbac.Add(new SelectListItem
    {
        Text = "Nhóm 3 - Trưởng phòng",
        Value = "3",
    });
    capbac.Add(new SelectListItem
    {
        Text = "Nhóm 4 - Phó phòng/Chuyên viên 2",
        Value = "4",
    });
    capbac.Add(new SelectListItem
    {
        Text = "Nhóm 5 - Kỹ sư/Cử nhân/Chuyên viên 1 (có quyết định làm quản lý)",
        Value = "5",
    });
    capbac.Add(new SelectListItem
    {
        Text = "Nhóm 6 - Kỹ thuật viên/NV nghiệp vụ (Đại học)",
        Value = "6",
    });
    capbac.Add(new SelectListItem
    {
        Text = "Nhóm 7 - Kỹ thuật viên/NV nghiệp vụ/ Tổ trưởng tài xế (Cao đẳng/ Trung cấp/ có quyết định làm quản lý)",
        Value = "7",
    });
    capbac.Add(new SelectListItem
    {
        Text = "Nhóm 8 - Kỹ thuật viên/NV nghiệp vụ/ Tổ trưởng Bảo Vệ (Cao đẳng/Trung cấp)",
        Value = "8",
    });
    capbac.Add(new SelectListItem
    {
        Text = "Nhóm 9 - Công nhân tay nghề (Có quyết định làm quản lý): Tổ trưởng/ nhóm trưởng QA/QC hoặc TT các chuyền)",
        Value = "9",
    });
    capbac.Add(new SelectListItem
    {
        Text = "Nhóm 10 -Công nhân tay nghề (Tài xế, CN các chuyền, CN QA/QC, Bảo vệ, Phụ kho)",
        Value = "10",
    });
    capbac.Add(new SelectListItem
    {
        Text = "Nhóm 11 - Lao động phổ thông (tạp vụ, phụ xe)",
        Value = "11",
    });
    foreach (var item in phanxuong)
    {
        if (item.Value == Model.Factory)
        { sxuong = item.Text; break; }
    }
    foreach (var item in capbac)
    {
        if (item.Value == Model.GroupID2.ToString())
        { scapbac = item.Text; break; }
    }
}
@section jsFooter
{
    <script src="/Scripts/ChangePasswordUser.js"></script>
    @*<script src="/Scripts/ViewInforUser.js"></script>*@
}

<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<div class="row">
    <h1>Thông tin nhân viên</h1>
</div>

<div class="tongthe row" >
    <div class="col-md-3">
        <div class="card card-primary card-outline">
            <div class="card-body box-profile">
                <div class="text-center">
                    @if (Model.Image != null)
                    {<img class="profile-user-img img-fluid img-circle" src="@Model.Image" alt="link hình bị lỗi" style="width: 100px; height: 130px; border-radius: 0%;border:none">}
                    else
                    { <img class="profile-user-img img-fluid img-circle" src="/Assets/theme3/dist/img/user.png" alt="User profile picture">}
                </div>
                <h3 class="profile-username text-center">Mã NV: @Model.ID</h3>
                <a href="#" class="btn btn-primary btn-block" data-toggle="modal" data-target="#myModalCancel"><b>Change Password</b></a>
            </div>
        </div>
        <div class="card card-primary card-outline">
            <div class="card-body">
                <strong><i class="fa fa-plane mr-1"></i>Ngày phép còn lại:@if(@Model.AllowedYear != null){<span> @Model.AllowedYear.Value.ToString()</span>}</strong> 
                <hr>
                <strong><i class="fa fa-book mr-1"></i>CCDC</strong> 
                @foreach (var item in listTool)
                {
                    <p class="text-muted">
                        - @item.ItemName (SL: @item.Quantity) - @item.Note -
                        <span class="badge badge-warning"><i class="fa fa-clock-o"></i>ngày cấp @item.StartDate.ToString("dd/MM/yyyy")</span>                        
                    </p>
                }
                <hr>
                <strong><i class="fa fa-file-text-o mr-1"></i> HĐLĐ</strong> 
                @foreach (var item in listHDLD)
                {
                    <p class="text-muted">
                        - @item.ID <span class="badge badge-warning"> <i class="fa fa-clock-o"></i>@item.StartDate.ToString("dd/MM/yyyy")</span> -
                        @if (item.EndDate == null)
                        {<span class="badge badge-warning"> <i class="fa fa-clock-o"></i>không xác định</span> }
                        else
                        {<span class="badge badge-warning"> <i class="fa fa-clock-o"></i>@item.EndDate.Value.ToString("dd/MM/yyyy")</span>}

                        @if (item.TypeH == 4)
                        {<a href="/HDLD/Print?id=@item.ID"><i class="fa fa-print" aria-hidden="true" style="font-size: 30px;"></i></a>}
                    </p>
                }
            </div>
        </div>
    </div>
    <div class="col-md-9">
        <div class="card card-primary card-outline">
            <div class="card-header">
                <h3 class="card-title">Cơ Bản</h3>
            </div>
            <div class="card-body">
                <div class="tab-content">
                    <div class="row">
                            <div class="col-md-12">
                                <div class="row">
                                    <div class='col-md-4'>
                                        <label class="control-label">Họ Tên</label>
                                        <input class="form-control" value="@Model.Name" />
                                    </div>
                                    <div class='col-md-2'>
                                        <label class="control-label">Nhóm</label>
                                        <input class="form-control" value="@sGroupID" />
                                    </div>
                                    <div class='col-md-2'>
                                        <label class="control-label">Xưởng</label>
                                        <input class="form-control" value="@Model.Factory" />
                                    </div>
                                    <div class='col-md-2'>
                                        <label class="control-label">Giới Tính</label>
                                        @if (@Model.Sex == true)
                                        {  <input class="form-control" value="Nam" /> }
                                        else
                                        { <input class="form-control" value="Nữ" />}
                                    </div>
                                    <div class='col-md-2'>
                                        <label class="control-label">Dân Tộc</label>
                                        <input class="form-control" value="@Model.Nation" />
                                    </div>

                                    <div class='col-md-3'>
                                        <label class="control-label">Vị Trí</label>
                                        <input class="form-control" value="@sIDPosition" />
                                    </div>
                                    <div class='col-md-3'>
                                        <label>Ngày Vào Làm</label>
                                        @if (@Model.StartDate != null)
                                        { <input class="form-control" value='@Model.StartDate.Value.ToString("dd/MM/yyyy")' />     }
                                    </div>
                                    <div class='col-md-3'>
                                        <label>Ngày Chính Thức</label>
                                        @if (@Model.EndTryDate != null)
                                        { <input class="form-control" value='@Model.EndTryDate.Value.ToString("dd/MM/yyyy")' />     }
                                    </div>
                                    <div class='col-md-3'>
                                        <label>Ngày Sinh</label>
                                        @if (@Model.Birthday != null)
                                        { <input class="form-control" value='@Model.Birthday.Value.ToString("dd/MM/yyyy")' />     }
                                    </div>
                                    <div class='col-md-3'>
                                        <label class="control-label">Điện Thoại</label>
                                        <input class="form-control" value="@Model.Phone" />
                                    </div>
                                    <div class='col-md-3'>
                                        <label class="control-label">Số CMND</label>
                                        <input class="form-control" value="@Model.CMNDCode" />
                                    </div>
                                    <div class='col-md-3'>
                                        <label>Ngày Cấp CMND</label>
                                        @if (@Model.CMNDDate != null)
                                        { <input class="form-control" value='@Model.CMNDDate.Value.ToString("dd/MM/yyyy")' />     }
                                    </div>
                                    <div class='col-md-3'>
                                        <label class="control-label">Nơi Cấp CMND</label>
                                        <input class="form-control" value="@sCMNDPlace" />
                                    </div>
                                    <div class='col-md-6'>
                                        <label class="control-label">Chuyên ngành - chuyên môn</label>
                                        <input class="form-control" value="@Model.Specialize" />
                                    </div>
                                    <div class='col-md-6'>
                                        <label class="control-label">Thông tin liên hệ khẩn cấp</label>
                                        <input class="form-control" value="@Model.InfoHotline" />
                                    </div>
                                    <div class='col-md-3'>
                                        <label class="control-label">Cấp Bậc</label>
                                        <input class="form-control" value="@scapbac" />
                                    </div>
                                    <div class='col-md-6'>
                                        <label class="control-label">Địa Chỉ</label>
                                        <input class="form-control" value="@Model.Address" />
                                    </div>
                                    <div class='col-md-3'>
                                        <label class="control-label">Thành Phố</label>
                                        <input class="form-control" value="@sCity" />
                                    </div>

                                    <div class='col-md-3'>
                                        <label class="control-label">Trình Độ</label>
                                        <input class="form-control" value="@sAcademicLevel" />
                                    </div>
                                    <div class='col-md-3'>
                                        <label class="control-label">Mã Số Thuế</label>
                                        <input class="form-control" value="@Model.TaxCode" />
                                    </div>
                                    <div class='col-md-3'>
                                        <label class="control-label">Người Giới Thiệu</label>
                                        <input class="form-control" value="@Model.Presenter" />
                                    </div>
                                    <div class='col-md-3'>
                                        <label class="control-label">Số Sổ BHXH</label>
                                        <input class="form-control" value="@Model.BHXHCode" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class='col-md-12'>
                                        <label class="control-label">Ghi Chú</label>
                                        <textarea class="form-control" cols="20" id="Note" name="Note" rows="5">@Model.Note</textarea>

                                    </div>
                                </div>
                            </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-12">
        <div class="card card-primary card-outline">
            <div class="card-header">
                <h3 class="card-title">Đào Tạo</h3>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>Hình thức</th>
                                <th>Nội dung</th>
                                <th>Ngày đào tạo</th>
                                <th>Thời gian</th>
                                <th>Người giảng dạy</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var item in listTraining)
                            {
                                <tr id="row_@item.ID">
                                    <td>
                                        @if (item.Type == 1)
                                        {
                                            <span><i class="fa fa-graduation-cap text-dark"> nội bộ</i> </span>
                                        }
                                        else
                                        {
                                            <span><i class="fa fa-graduation-cap text-dark">bên ngoài</i> </span>
                                        }
                                    </td>
                                    <td><a href="/Training/Edit/@item.ID"> <span class="text">@item.Name</span></a></td>
                                    <td>
                                        <span class="badge badge-success"><i class="fa fa-calendar"></i>@item.StartDate.Value.ToString("dd/MM/yyyy") </span>
                                    </td>
                                    <td>
                                        <span class="badge badge-dark"><i class="fa fa-clock-o"></i>@item.Time tiếng </span>
                                    </td>
                                    <td><span class="badge badge-warning float-right"><i class="fa fa-user"></i> @item.TeacherName </span></td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div><!-- /.card-body -->
    </div>
   
</div>



<form id="myFormCancel" method="post">
    <div class="modal fade" id="myModalCancel" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Điền mật khẩu mới</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>

                </div>
                <div class="modal-body">
                    <input class="form-control" data-val="true" id="passw" name="pass" type="password" value="">
                </div>
                <script>
                    $(document).ready(function () {
                        $("#passw").blur(function () {
                            var newpass = $('#passw').val();
                            var abc = $('#huyphieu').attr("data-pass", newpass);

                        });
                    });
                </script>

                <div class="modal-footer">
                    <a href="#" id="huyphieu" class="btn-cancel" data-pass="" style="background: red;    padding: 7px;  color: white;">ĐỔI MẬT KHẨU</a>
                </div>
            </div>

        </div>
    </div>
</form>

<script type="text/javascript">
    $(window).on('load', function () {
        $('#myModalxn').modal('show');
    });
</script>

@*<form id="myFormCancel" method="post">
    <div class="modal hide fade"  id="myModalxn" role="dialog" style="width:300px">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Nhập lại mật khẩu đăng nhập</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    <input class="form-control" data-val="true" id="passw2" name="pass" type="password" value="">
                </div>
                
                <script>
                    $(document).ready(function () {
                        $("#passw2").blur(function () {
                            var newpass = $('#passw2').val();
                            var abc = $('#xacnhan').attr("data-pass", newpass);
                        });
                    });
                </script>
                <div class="modal-footer">
                    <a href="#" id="xacnhan" class="" data-pass="" style="background: red; padding: 7px;  color: white;">XÁC NHẬN</a>
                </div>
            </div>

        </div>
    </div>
</form>*@