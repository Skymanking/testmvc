@model List<Model.EF.PInOutAll>
@{
    ViewBag.Title = "Report";
    Layout = "~/Views/Shared/_Theme3.cshtml";
    string ngaythangnam = "INPUTDATA" + DateTime.Now.ToUniversalTime();
    var manage = new List<SelectListItem>
        ();
    var listS = (IEnumerable<Model.EF.Personal>)ViewBag.liststaff;
    manage.Add(new SelectListItem
    {
        Text = "Tất cả",
        Value = "All",
    });
    foreach (var item in listS)
    {
        manage.Add(new SelectListItem
        {
            Text = item.ID + item.Name,
            Value = item.ID.ToString(),
        });
    }
}
<link rel="stylesheet" href="/Assets/theme3/plugins/datatables/dataTables.bootstrap4.min.css">

<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<link href="~/Assets/js/jquery-ui.css" rel="stylesheet" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<script src="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.jquery.min.js"></script>
<link href="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.min.css" rel="stylesheet" />
<style>
    .center {
        margin: auto;
        width: 85%;
        border: 3px solid green;
        padding: 10px;
    }
</style>
@section jsFooter
{
    <script src="/Assets/plugin/ckfinder/ckfinder.js"></script>
    <script src="/Assets/theme3/plugins/datepicker/js/bootstrap-datetimepicker.js"></script>
    <script src="/Assets/theme3/plugins/datepicker/js/locales/bootstrap-datetimepicker.fr.js" charset="UTF-8"></script>
    <script src="/Assets/theme3/plugins/timepicker/bootstrap-timepicker.min.js"></script>
    <script src="/Assets/theme3/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="/Assets/theme3/plugins/datatables/dataTables.bootstrap4.min.js"></script>
    <script src="/Assets/theme3/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/Assets/theme3/plugins/chartjs-old/Chart.min.js"></script>
    <script src="/Assets/theme3/plugins/fastclick/fastclick.js"></script>
    <script src="/Assets/theme3/dist/js/adminlte.min.js"></script>
    <script src="/Assets/theme3/dist/js/demo.js"></script>
    <script>
        $(function () {
            $("#ngay1").datepicker();
            $("#ngay2").datepicker();
            $('input[type="checkbox"].flat-green, input[type="radio"].flat-green').iCheck({
                checkboxClass: 'icheckbox_flat-green',
                radioClass: 'iradio_flat-green'
            })
        })
        $(function () {
            $("#example1").DataTable(
                {
                    "paging": false,
                    "lengthChange": false,
                    "searching": true,
                    "ordering": true,
                    "info": false,
                    "autoWidth": false});
            $('#example2').DataTable({
                "paging": true,
                "lengthChange": false,
                "searching": true,
                "ordering": true,
                "info": true,
                "autoWidth": false
            });
        });
    </script>
}
<link href="~/Assets/js/jquery-ui.css" rel="stylesheet" />

<div class="card card-primary">

    <div class="card-header">
        <h3 class="card-title">Report Ra vào cổng</h3>
        <div class="card-tools">
            <div class="btn-group" style="height:37px">
                <button type="button" class="btn btn-success btn-sm dropdown-toggle" data-toggle="dropdown">
                    More
                </button>
                <div class="dropdown-menu float-right" role="menu">
                </div>
            </div>


        </div>

    </div>

    <div class="card-body">
        @using (Html.BeginForm("report", "PInOut", FormMethod.Get))
        {
            <div class="row">
                <div class="col-md-3">
                    <div class="callout callout-info">
                        <label class="control-label" style="color: #FF5722;">Nhân viên</label><br>
                        <select data-placeholder="Nhân viên" multiple class="chosen-select" id="dep" style="width:100%">
                            @foreach (var st in manage)
                            {
                                <option value="@st.Value">@st.Text</option>
                            }
                        </select>
                        <input type="hidden" id="ListDep" name="staff" />
                        <script type="text/javascript">
                            $("#dep").chosen({
                                disable_search_threshold: 10
                            }).change(function (event) {
                                if (event.target == this) {
                                    document.getElementById("ListDep").value = $(this).val();
                                }
                            });
                            $(".chosen-select").chosen({
                                no_results_text: "Không tìm thấy:"
                            });
                        </script>

                    </div>
                </div>
                <div class="col-md-2">
                    <label class="control-label" style="color: #FF5722;">Ngày</label>
                    <div class="bootstrap-timepicker">
                        <div class="form-group">
                            <div class="input-group">
                                <input type="text" id="ngay1" name="start" class="form-control" value="@if(ViewBag.start!=null){@ViewBag.start}else{@DateTime.Now.ToShortDateString()}"><br>
                                <div class="input-group-append">
                                    <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <label class="control-label" style="color: #FF5722;">Đến</label>
                    <div class="bootstrap-timepicker">
                        <div class="form-group">
                            <div class="input-group">
                                <input type="text" id="ngay2" name="end" class="form-control" value="@if(ViewBag.end!=null){@ViewBag.end}else{@DateTime.Now.ToShortDateString()}"><br>
                                <div class="input-group-append">
                                    <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="col-md-3">
                        <label class="control-label" style="color: #FF5722;">Tìm</label><br>

                        <div class="input-group-append">
                            <button type="submit" class="btn btn-default"><i class="fa fa-search"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        }


        <script src="~/Scripts/jquery-1.9.1.min.js"></script>
    </div>
    <div class="card-footer">

    </div>

</div>
<div class="row">
    <div class="col-md-12">
        <div class="card card-success card-outline">
            <div class="card-header">
                <div class="card-body">
                    <div class="table-responsive">
                        <script>
                            function exportTableToExcel(tableID, filename) {
                                var downloadLink;
                                var dataType = 'application/vnd.ms-excel';
                                var tableSelect = document.getElementById(tableID);
                                var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');
                                filename = filename ? filename + '.xls' : 'excel_data.xls';
                                downloadLink = document.createElement("a");
                                document.body.appendChild(downloadLink);
                                if (navigator.msSaveOrOpenBlob) {
                                    var blob = new Blob(['\ufeff', tableHTML], {
                                        type: dataType
                                    });
                                    navigator.msSaveOrOpenBlob(blob, filename);
                                } else {
                                    downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
                                    downloadLink.download = filename;
                                    downloadLink.click();
                                }
                            }
                        </script>
                        <table class="table table-striped table-bordered table-hover" id="example1">
                            <thead>
                                <tr>
                                    <th style="width:50px">Mã NV</th>
                                    <th style="width: 300px">Tên NV</th>
                                    <th style="width: 150px">Thời gian từ </th>
                                    <th style="width: 150px">Thời gian đến</th>
                                    <th>Lý do</th>
                                    <th style="width:50px">View</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model != null)
                                {
                                    foreach (var item in Model)
                                    {
                                        <tr id="row_@item.PerID">
                                            <td>@item.PerID</td>
                                            <td>@item.NamePer</td>
                                            <td>@item.TimeFrom</td>
                                            <td>@item.TimeTo</td>
                                            <td>@item.ReasonType</td>
                                            <td><a href="/PInOut/Edit/@item.ID"><span class='fa fa-eye' style="font-size: 22px;"></span></a></td>
                                        </tr>
                                    }
                                }
                            </tbody>
                        </table>

                    </div>
                </div>
                <div class="card-footer clearfix">

                </div>
                <!-- /.panel-body -->
            </div>

        </div>
    </div>
</div>
