@model List<Model.EF.PInOutPer>
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Theme3.cshtml";
    string ngaythangnam = "INPUTDATA" + DateTime.Now.ToUniversalTime();
    var manage = new List<SelectListItem>
        ();
    var listS = (IEnumerable<Model.EF.Personal>)ViewBag.liststaff;
    manage.Add(new SelectListItem
    {
        Text = "Tất cả",
        Value = "All",
    });
}
<link rel="stylesheet" href="/Assets/theme3/plugins/datatables/dataTables.bootstrap4.min.css">

<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<link href="~/Assets/js/jquery-ui.css" rel="stylesheet" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<script src="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.jquery.min.js"></script>
<link href="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.min.css" rel="stylesheet" />
<style>
    .center {
        margin: auto;
        width: 85%;
        border: 3px solid green;
        padding: 10px;
    }
</style>
@section jsFooter
{
    <script src="/Assets/plugin/ckfinder/ckfinder.js"></script>
    <script src="/Assets/theme3/plugins/datepicker/js/bootstrap-datetimepicker.js"></script>
    <script src="/Assets/theme3/plugins/datepicker/js/locales/bootstrap-datetimepicker.fr.js" charset="UTF-8"></script>
    <script src="/Assets/theme3/plugins/timepicker/bootstrap-timepicker.min.js"></script>
    <script src="/Assets/theme3/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="/Assets/theme3/plugins/datatables/dataTables.bootstrap4.min.js"></script>
    <script src="/Assets/theme3/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/Assets/theme3/plugins/chartjs-old/Chart.min.js"></script>
    <script src="/Assets/theme3/plugins/fastclick/fastclick.js"></script>
    <script src="/Assets/theme3/dist/js/adminlte.min.js"></script>
    <script src="/Assets/theme3/dist/js/demo.js"></script>
    <script>
        $(function () {
            $("#example1").DataTable(
                {
                    "paging": false,
                    "lengthChange": false,
                    "searching": true,
                    "ordering": true,
                    "info": false,
                    "autoWidth": false,
                    order: [[2, 'desc'], [3, 'desc']],
                });            $("#ngay2").datepicker();
            $('input[type="checkbox"].flat-green, input[type="radio"].flat-green').iCheck({
                checkboxClass: 'icheckbox_flat-green',
                radioClass: 'iradio_flat-green'
            })
        })
        $(function () {
            $("#example1").DataTable();
            $('#example2').DataTable({
                "paging": true,
                "lengthChange": false,
                "searching": true,
                "ordering": true,
                "info": true,
                "autoWidth": false
            });
        });
    </script>
}
<link href="~/Assets/js/jquery-ui.css" rel="stylesheet" />

<div class="card card-primary">

    <div class="card-header">
        <h3 class="card-title">Report ra vào cổng chi tiết theo bộ phận</h3>
        <div class="card-tools">
            <div class="btn-group" style="height:37px">
                <button type="button" class="btn btn-success btn-sm dropdown-toggle" data-toggle="dropdown">
                    More
                </button>
                <div class="dropdown-menu float-right" role="menu">
                </div>
            </div>


        </div>

    </div> 
</div>
@if (Model != null)
{
    <div class="row">
        <div class="col-12" style="height:80%">
            <div class="chart center">
                <canvas id="barChart" style="min-height: 250px; height: 500px; max-height: 500px; max-width: 100%;"></canvas>
            </div>
        </div>
    </div>

    <script type="text/javascript" charset="utf-8">
        $(function () {
            var areaChartData = {
                labels: [
                    @foreach (var item in Model)
                    {
                            <text>
                    '@item.empCode',
                           </text>
                    }
                ],
                datasets: [
                    {
                        label: 'Electronics',
                        fillColor: '#00bcd4',
                        strokeColor: 'rgba(210, 214, 222, 1)',
                        pointColor: 'rgba(210, 214, 222, 1)',
                        pointStrokeColor: '#c1c7d1',
                        pointHighlightFill: '#fff',
                        pointHighlightStroke: 'rgba(220,220,220,1)',
                        data: [@foreach (var item in Model)
                        {
                            <text>
                            '@item.TimeCo',
                           </text>
                        }]
                    },
                    {
                        label: 'Digital Goods',
                        fillColor: '#ff9800',
                        strokeColor: 'rgba(60,141,188,0.8)',
                        pointColor: '#3b8bba',
                        pointStrokeColor: 'rgba(60,141,188,1)',
                        pointHighlightFill: '#fff',
                        pointHighlightStroke: 'rgba(60,141,188,1)',
                        data: [                    @foreach (var item in Model)
                        {
                            <text>
                            '@item.TimePer',
                           </text>
                        }]
                    }
                ]
            }
            var barChartCanvas = $('#barChart').get(0).getContext('2d')
            var barChart = new Chart(barChartCanvas)
            var barChartData = areaChartData
            barChartData.datasets[1].fillColor = '#00a65a'
            barChartData.datasets[1].strokeColor = '#00a65a'
            barChartData.datasets[1].pointColor = '#00a65a'
            var barChartOptions = {
                scaleBeginAtZero: true,
                scaleShowGridLines: true,
                scaleGridLineColor: 'rgba(0,0,0,.05)',
                scaleGridLineWidth: 1,
                scaleShowHorizontalLines: true,
                scaleShowVerticalLines: true,
                barShowStroke: true,
                barStrokeWidth: 2,
                barValueSpacing: 5,
                barDatasetSpacing: 1,
                legendTemplate: '<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',
                responsive: true,
                maintainAspectRatio: true
            }

            barChartOptions.datasetFill = true
            barChart.Bar(barChartData, barChartOptions)
        })
    </script>
}

<div class="row">
    <div class="col-md-12">
        <div class="card card-success card-outline">
            <div class="card-header">
                <div class="card-body">
                    <div class="table-responsive">
                        <div class="card-header">
                            <h3 class="card-title"><i class="fa fa-clipboard"></i> <span id="sokq" style="color:red;font-weight:bold;"></span> Kết quả</h3>
                            <div class="card-tools">
                                <div class="btn-group" style="height:40px">
                                    <button type="button" class="btn btn-success btn-sm dropdown-toggle" data-toggle="dropdown">
                                        Tool
                                    </button>
                                    <div class="dropdown-menu float-right" role="menu">
                                        <span class="dropdown-item" onclick="exportTableToExcel('baocom', '@ngaythangnam')">Export to Excel</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <script>
                            function exportTableToExcel(tableID, filename) {
                                var downloadLink;
                                var dataType = 'application/vnd.ms-excel';
                                var tableSelect = document.getElementById(tableID);
                                var tableHTML = tableSelect.outerHTML.replace(/ /g, '%20');
                                filename = filename ? filename + '.xls' : 'excel_data.xls';
                                downloadLink = document.createElement("a");
                                document.body.appendChild(downloadLink);
                                if (navigator.msSaveOrOpenBlob) {
                                    var blob = new Blob(['\ufeff', tableHTML], {
                                        type: dataType
                                    });
                                    navigator.msSaveOrOpenBlob(blob, filename);
                                } else {
                                    downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
                                    downloadLink.download = filename;
                                    downloadLink.click();
                                }
                            }
                        </script>
                        <table class="table table-striped table-bordered table-hover" id="example1">
                            <thead>
                                <tr>
                                    <th>Mã NV</th>
                                    <th>Tên NV</th>
                                    <th>Số phiếu nghỉ/tổng phiếu</th>
                                    <th>Thời gian đi cho công ty</th>
                                    <th>Thời gian cá nhân</th>
                                    <th>Tuyến đường đi nhiều nhất</th>
                                    <th>Chi tiết</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model != null)
                                {
                                    foreach (var item in Model)
                                    {
                                <tr id="row_@item.empCode">
                                    <td>@item.empCode</td>
                                    <td>@item.Name</td>
                                    <td>@item.offShiff/@item.Total</td>
                                    <td>@item.TimeCo</td>
                                    <td>@item.TimePer</td>
                                    <td>@item.MostTravel</td>
                                    <td><a href="/PInOut?searchString=@item.empCode"><span class='fa fa-eye' style="font-size: 22px;"></span></a></td>

                                </tr>
                                    }
                                }
                            </tbody>
                        </table>

                    </div>
                </div>
                <div class="card-footer clearfix">

                </div>
                <!-- /.panel-body -->
            </div>

        </div>
    </div>
</div>
