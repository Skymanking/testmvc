@{
    ViewBag.Title = "View";
    Layout = "~/Views/Shared/_Theme1.cshtml";
    var infoCreateBy = (Model.View.UserView1)ViewBag.ngtao;
    var detail = (Model.View.FullPTB)ViewBag.detail;
    var lenght = detail.detail.Count();
}
<div class="row">
    <div class="col-md-12">
        <h1 class="page-header">Phiếu Yêu Cầu Mua Vật Tư (PTE)</h1>
    </div>
</div>
<div class="row">
    <!-- Cot ben trai -->
    <div class="col-md-12">
        <div class="panel panel-primary">
            <div class="panel-heading">
                Thông Tin Yêu Cầu Mua Vật Tư Đã Được Duyệt - Số Phiếu: <strong>@detail.item.ID</strong>
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-md-6 col-xs-6">
                                <p>Người Đề Nghị: <strong>@infoCreateBy.FullName</strong></p>
                            </div>
                            <div class="col-md-6 col-xs-6">
                                <p>Bộ phận: <strong>@infoCreateBy.DepartmentName</strong></p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <p>Lý do: @detail.item.Reason</p>
                            </div>
                        </div>
                        <div class="row">
                            <div class='col-md-6 col-xs-6'>
                                <p>Ngày yêu cầu: @detail.item.CreateDate.ToString("dd/MM/yyyy")</p>

                            </div>
                            <div class='col-md-6 col-xs-6'>
                                <p>Thời hạn đáp ứng: @detail.item.LimitedDate.ToString("dd/MM/yyyy") </p>
                            </div>
                        </div>
                        <div class="row" style="padding-top:5px;margin:20px;">
                            <table class="table table-striped table-bordered table-hover" id="gvCustomers">
                                <thead>
                                    <tr>
                                        <th>STT</th>
                                        <th>Tên vật tư</th>
                                        <th>Ghi chú</th>
                                        <th>Đơn giá</th>
                                        <th>ĐVT</th>
                                        <th>Số lượng</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @for (int i = 0; i < lenght; i++)
                                    {
                                        <tr id="row">
                                            <td>  @detail.detail[i].No</td>
                                            <td>   @detail.detail[i].MaterialName</td>
                                            <td>  @detail.detail[i].Note</td>
                                            <td>  
                                                @if (detail.detail[i].Price!=null)
                                                {<span>@detail.detail[i].Price.Value.ToString("N0").Replace(',', '.') vnđ</span>}
                                            </td>
                                            <td>  @detail.detail[i].Unit</td>
                                            <td>  @detail.detail[i].Quantity</td>
                                        </tr>
                                    }
                                   
                                </tbody>
                            </table>
                            @if (detail.item.Files != null)
                            {
                                <div id="upload" style="margin-top: 10px; border: 1px solid #f2dede; padding: 10px; background: #fcf8e3; " class="col-md-12">
                                    @Html.ActionLink("Xem file giải trình, thiết kế ...được đính kèm theo", "DownloadFile", new { fileName = @detail.item.Files })
                                </div>
                            }
                            <script>
                                $(document).ready(function () {
                                    $("#files").change(function () {
                                        if ($("#files").val().substring(12, 400).length > 2) {
                                            var linktext = "/ProposalToBuy/DownloadFile?fileName=" + $("#files").val().substring(12, 400);
                                            $("#linkfile").attr("href", linktext);
                                            $("#linkfile").show();
                                        }
                                        else { $("#linkfile").hide(); }
                                    });
                                });
                            </script>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <p>Ý kiến của Giám Đốc: @detail.item.Confirm</p>
                            </div>
                        </div>
                        <div class="row">
                            <div class='col-md-6 col-xs-6'>
                                <p>Ngày Trưởng Phòng Duyệt: @detail.item.HODDate.Value.ToString("dd/MM/yyyy")</p>

                            </div>
                            <div class='col-md-6 col-xs-6'>
                                <p>Ngày Giám Đốc Duyệt: @detail.item.BOSSDate.Value.ToString("dd/MM/yyyy") </p>

                            </div>

                        </div>

                    </div>
                </div>
            </div>
        </div>

    </div>



</div>



<p></p>
<p></p>
<p></p>
<p></p>
