@model Model.EF.ProposalRecruitment
@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_Theme3.cshtml";
    var infoCreateBy = (Model.View.UserView1)ViewBag.ngtao;
    var listdatuyen = (List<Model.View.Personal6>)ViewBag.listdatuyen;
    var listCV = (List<Model.View.Candidate5>)ViewBag.listCV;


    List<SelectListItem> trinhdo = new List<SelectListItem>();
    trinhdo.Add(new SelectListItem
    {
        Text = "Phổ thông",
        Value = "Phổ thông",
        Selected = true
    });
    trinhdo.Add(new SelectListItem
    {
        Text = "Trung Cấp",
        Value = "Trung Cấp",
    });
    trinhdo.Add(new SelectListItem
    {
        Text = "Cao Đẳng",
        Value = "Cao Đẳng",
    });
    trinhdo.Add(new SelectListItem
    {
        Text = "Đại Học",
        Value = "Đại Học",
    });
    trinhdo.Add(new SelectListItem
    {
        Text = "Thạc Sĩ",
        Value = "Thạc Sĩ",
    });

    List<SelectListItem> kinhnghiem = new List<SelectListItem>();
    kinhnghiem.Add(new SelectListItem
         {
             Text = "Không yêu cầu",
             Value = "Không yêu cầu",
             Selected = true
         });
    kinhnghiem.Add(new SelectListItem
         {
             Text = "1 - 2 năm",
             Value = "1 - 2 năm",
         });
    kinhnghiem.Add(new SelectListItem
    {
        Text = "3 - 5 năm",
        Value = "3 - 5 năm",
    });
    kinhnghiem.Add(new SelectListItem
    {
        Text = "trên 5 năm",
        Value = "trên 5 năm",
    });

    List<SelectListItem> loainv = new List<SelectListItem>();
    loainv.Add(new SelectListItem
         {
             Text = "Lao động phổ thông < 15 ngày",
             Value = "15",
             Selected = true
         });
    loainv.Add(new SelectListItem
         {
             Text = "NV văn phòng, gián tiếp, bảo vệ < 30 ngày",
             Value = "30",
         });
    loainv.Add(new SelectListItem
    {
        Text = "Công nhân kỹ thuật có tay nghề < 35 ngày",
        Value = "35",
    });
    loainv.Add(new SelectListItem
    {
        Text = "Quản lý cấp trung < 45 ngày",
        Value = "45",
    });
    loainv.Add(new SelectListItem
         {
             Text = "Quản lý cấp cao < 60 ngày",
             Value = "60",
         });
    loainv.Add(new SelectListItem
    {
        Text = "Cấp lãnh đạo < 90 ngày",
        Value = "90",
    });


}
@section jsFooter
{
    <script src="/Scripts/CancelRecruitment.js"></script>

}
<script src="~/Scripts/jquery-3.4.1.min.js"></script>

<link href="~/Assets/js/jquery-ui.css" rel="stylesheet" />
<script type="text/javascript">
    $(function () {

        $('.select2').select2()
        $(".date1").datepicker(
            {
                dateFormat: 'mm/dd/yy',
                changeMonth: true,
                changeYear: true,
                numberOfYears: 1,
                numberOfMonths: 1,
                yearRange: "-90:+10",
                onSelect: function (selectedDate) {
                    // we can write code here
                }
            });
        $(".date2").datepicker();
        $('#datemask2').inputmask('mm/dd/yyyy', { 'placeholder': 'mm/dd/yyyy' })
        //Money Euro
        $('[data-mask]').inputmask()

    })
</script>



<div class="card card-primary">
    <div class="card-header">
        <h3 class="card-title">Yêu Cầu Tuyển Dụng</h3>
    </div>
    @using (Html.BeginForm("Edit", "ProposalRecruitment", FormMethod.Post))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="card-body">
            <div class="row">

                <div class="col-md-3">
                    <label class="control-label">Người Đề Nghị: </label>
                    <label class="form-control">  @infoCreateBy.FullName</label>
                </div>
                <div class="col-md-3">
                    <label class="control-label">Bộ phận: </label>
                    <label class="form-control">  @infoCreateBy.DepartmentName</label>
                </div>
                <div class="col-md-3">
                    <label class="control-label">Ngày tạo: </label>
                    <label class="form-control">  @Model.CreateDate</label>
                </div>
                <div class="col-md-3" style="display:block">
                    @Html.TextBoxFor(model => model.ID, new { @class = "form-control", @style = "display: none; visibility: hidden;" })
                </div>

                <div class='col-md-8'>
                    <label class="control-label">Lý Do</label>
                    @Html.TextBoxFor(model => model.Reason, new { @class = "form-control", @placeholder = "lý do tuyển dụng" })
                    @Html.ValidationMessageFor(model => model.Reason, "", new { @class = "text-danger" })
                </div>


                <div class='col-md-4'>
                    <label class="control-label">Chức vụ / Vị trí</label>
                    @Html.TextBoxFor(model => model.Position, new { @class = "form-control", @placeholder = "chức vụ cần tuyển" })
                    @Html.ValidationMessageFor(model => model.Position, "", new { @class = "text-danger" })
                </div>
                <div class='col-md-2'>
                    <label class="control-label">Số lượng cần tuyển</label>
                    @Html.TextBoxFor(model => model.Quantity, new { @class = "form-control", @type = "number" })
                    @Html.ValidationMessageFor(model => model.Quantity, "", new { @class = "text-danger" })
                </div>

                <div class='col-md-4'>
                    <label class="control-label">Loại Nhân Viên</label>
                    @Html.DropDownListFor(model => model.TypeJob, loainv, new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.TypeJob, "", new { @class = "text-danger" })
                </div>
                <div class='col-md-4'>
                    <label class="control-label">Trình Độ</label>
                    @Html.DropDownListFor(model => model.AcademicLevel, trinhdo, new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.AcademicLevel, "", new { @class = "text-danger" })
                </div>
                <div class='col-md-2'>
                    <label class="control-label">Kinh Nghiệm</label>
                    @Html.DropDownListFor(model => model.Experience, kinhnghiem, new { @class = "form-control" })
                    @Html.ValidationMessageFor(model => model.Experience, "", new { @class = "text-danger" })
                </div>

                <div class='col-md-12'>
                    <label class="control-label">Những yêu cầu khác</label>
                    @Html.TextAreaFor(model => model.Other, new { @class = "form-control", @rows = "10" })
                    @Html.ValidationMessageFor(model => model.Other, "", new { @class = "text-danger" })
                </div>
            </div>

            <table class="table table-striped table-bordered table-hover">
                <thead>
                    <tr>
                        <th style="width:50%;">TP Nhân Sự duyệt</th>
                        <th style="width:50%;">Ban Giám Đốc duyệt</th>
                    </tr>

                </thead>
                <tbody>
                    <tr id="row_0">
                        <td>@Html.CheckBoxFor(model => model.RecruiterApproval, new { @style = "height:90px; width:90px;" })</td>
                        <td>@Html.CheckBoxFor(model => model.BOSSApproval, new { @style = "height:90px; width:90px;" })</td>

                    </tr>
                    <tr>
                        <th></th>
                        <th>
                            @if (@Model.ApprovalDate != null)
                            {<span>@Model.NameApproval đã duyệt: @Model.ApprovalDate.Value.ToString("MM/dd/yyyy")</span>}
                        </th>
                    </tr>
                </tbody>
            </table>
            <!--------------------------fd-------End------------------------------------>
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">DANH SÁCH HỒ SƠ ỨNG VIÊN</h3>
                </div>
                <div class="card-body">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>Ngày tạo</th>
                                <th>Tên Ứng Viên</th>
                                <th>File Hồ sơ</th>
                                <th>Nhận xét của TBP</th>
                                <th>Tham gia PV</th>
                                <th>Thời gian PV</th>
                                <th>Kết quả PV</th>
                                <th>Nhận việc</th>
                            </tr>

                        </thead>
                        <tbody>
                            @foreach (var item in listCV)
                            {
                                <tr id="row_0">

                                    <td>@item.CreateDate.ToString("dd/MM/yyyy")</td>
                                    <td>@item.Name</td>
                                    <td>
                                        @if (item.FileName != null && item.FileName.Length > 10)
                                        {<a href="@item.FileName"><i class="fa fa-file-pdf-o" aria-hidden="true" style="font-size:22px"></i></a>}
                                        else { }
                                    </td>
                                    <td>
                                        @if (item.CVComment2 == 1)
                                        {<span>CV Đạt</span>}
                                        else
                                        {
                                            if (item.CVComment2 == 0)
                                            {<span>CV ko đạt</span>}
                                            else
                                            {<span>Chưa nhận xét</span>}
                                        }
                                    </td>
                                    <td>
                                        @if (item.UVAgree1 == 1)
                                        {<span>Đồng ý PV</span>}
                                        else
                                        {
                                            if (item.UVAgree1 == 0)
                                            {<span>Ko Đồng ý</span>}
                                            else
                                            {<span>Chưa chọn</span>}
                                        }
                                    </td>
                                    <td>
                                        @if (item.InterviewTime != null)
                                        {<span>@item.InterviewTime.ToString()</span>}
                                        else { }
                                    </td>
                                    <td>
                                        @if (item.ResultPV == 1)
                                        {<span>Đậu</span> }
                                        else
                                        {
                                            if (item.ResultPV == 0)
                                            {<span>Rớt</span>}
                                            else
                                            {
                                                if (item.ResultPV == 2)
                                                {<span>chưa chọn</span>}
                                                else
                                                {
                                                    if (item.ResultPV == 3)
                                                    {<span>Xem xét lại</span>}
                                                    else
                                                    {<span>Không đến PV</span>}
                                                }
                                            }
                                        }

                                    </td>
                                    <td>
                                        @if (item.UVAgree2 == 1)
                                        {<span>Đồng ý</span> }
                                        else
                                        {
                                            if (item.UVAgree2 == 0)
                                            {<span>Ko Đồng ý</span>}
                                            else
                                            {<span>Chưa chọn</span>}
                                        }
                                    </td>
                                </tr>
                            }

                        </tbody>
                    </table>

                </div>               
            </div>
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">DANH SÁCH NHÂN VIÊN ĐÃ NHẬN VIỆC</h3>
                </div>
                <div class="card-body">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>Mã NV</th>
                                <th>Tên NV</th>
                                <th>Ngày vào làm</th>
                                <th>Tình trạng</th>
                                <th>Ký HDLD 1 năm</th>
                            </tr>

                        </thead>
                        <tbody>
                            @foreach (var item in listdatuyen)
                            {
                                <tr id="row_0">

                                    <td>@item.ID</td>
                                    <td>@item.Name</td>
                                    <td>@if (item.StartDate != null)
                                    { @item.StartDate.Value.ToString("dd/MM/yyyy")}</td>
                                    <td>@if (item.Status == true)
                                    {<span>còn làm</span>}
                                    else
                                    {<span>đã nghỉ</span>}</td>
                                    <td>@if (item.haveHDLD == true)
                                    {<span>đã ký</span>}
                                    else
                                    {<span>chưa ký</span>}</td>
                                </tr>
                            }

                        </tbody>
                    </table>
                </div>
            </div>
            <div class="form-group">
                <div class="row">
                    <div class='col-md-12'>
                        <div class="alert alert-info alert-dismissible">
                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                            <h5><i class="icon fa fa-info"></i> Phần Nhân Sự Ghi Chú</h5>
                        </div>
                    </div>

                    <div class='col-md-3'>
                        <label>Ngày UV nhận việc</label>
                        <div class="input-group mb-3">
                            <input autocomplete="off" class="date1 form-control" id="StartDate" name="StartDate" type="text" value="@if(@Model.StartDate!=null){ @Model.StartDate.Value.ToString("MM/dd/yyyy")} ">

                            <div class=" input-group-append">
                                <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                            </div>
                        </div>
                    </div>

                    <div class='col-md-3'>
                        <label class="control-label">Số lượng UV nhận việc</label>
                        @Html.TextBoxFor(model => model.CountOK, new { @class = "form-control", @type = "number" })
                    </div>

                    <div class='col-md-12'>
                        <label class="control-label">Ghi chú sau khi phỏng vấn</label>
                        @Html.TextAreaFor(model => model.NoteAdmin, new { @class = "form-control", @rows = "5" })
                        @Html.ValidationMessageFor(model => model.NoteAdmin, "", new { @class = "text-danger" })
                    </div>

                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th style="width:50%;">Đã có ứng viên nhận việc</th>
                                <th style="width:50%;">TBP Xác nhận đã có nhân viên</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="row_0">
                                <td>@Html.CheckBoxFor(model => model.StartConfirm, new { @style = "height:90px; width:90px;" })</td>
                                <td>@Html.CheckBoxFor(model => model.OwnerConfirm, new { @style = "height:90px; width:90px;" })</td>

                            </tr>
                            <tr id="row_0">
                                <td>
                                    @if (@Model.StartDate != null)
                                    {@Model.StartDate.Value.ToString("MM/dd/yyyy")}
                            </td>
                            <td>
                                @if (@Model.ConfirmDate != null)
                                {@Model.ConfirmDate.Value.ToString("MM/dd/yyyy")}
                        </td>

                    </tr>
                </tbody>
            </table>

        </div>



    </div>
</div>
        <div class="card-footer">
            <button type="submit" class="btn btn-primary">Lưu thông tin</button>
            <button type="button" class="btn btn-danger float-right" data-toggle="modal" data-target="#myModal">Xóa Phiếu Yêu Cầu </button>

        </div>
    }
</div>






<form id="myForm" method="post">
    <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">

            Modal content
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Lý do xóa phiếu</h4>
                </div>
                <div class="modal-body">
                    <input class="form-control" data-val="true" id="lydo" name="lydo" placeholder="điền lý do hủy phiếu " type="text" value="">
                </div>
                <script>
                    $(document).ready(function () {
                        $("#lydo").keypress(function () {
                            var lydos = $('#lydo').val();
                            var abc = $('#huyphieu').attr("data-lydo", lydos);

                        });
                    });
                </script>

                <div class="modal-footer">
                    <a href="#" id="huyphieu" class="btn-cancel" data-id="@Model.ID" style="background: red;    padding: 7px;  color: white;">Gửi mail thông báo và Xóa Phiếu</a>
                </div>
            </div>

        </div>
    </div>
</form>
