@model PagedList.IPagedList<Model.View.ProposalToBuyView1>
@using PagedList.Mvc;
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Theme3.cshtml";
    int count = 0;
    int stt = 1;
    string ngaythangnam = "ReportMH" + DateTime.Now.ToUniversalTime();
}

@section jsFooter
{

    <script src="/Assets/theme3/plugins/timepicker/bootstrap-timepicker.min.js"></script>
    <script>
        $(function () {
            $("#ngay1").datepicker();
            $("#ngay2").datepicker();
            $('input[type="checkbox"].flat-green, input[type="radio"].flat-green').iCheck({
                checkboxClass: 'icheckbox_flat-green',
                radioClass: 'iradio_flat-green'
            })
        })
    </script>
}
<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<link href="~/Assets/js/jquery-ui.css" rel="stylesheet" />
<div class="card card-primary">
    <div class="card-header">
        <h3 class="card-title">Tìm kiếm nâng cao</h3>
        <div class="card-tools">
            <div class="btn-group" style="height:37px">
                <button type="button" class="btn btn-success btn-sm dropdown-toggle" data-toggle="dropdown">
                    More
                </button>
                <div class="dropdown-menu float-right" role="menu">
                    <a href="/ProposalToBuy/" style="color:black;" class="dropdown-item">Normal</a>
                    <a href="/ProposalToBuy/SearchAdvance1" style="color:black;" class="dropdown-item">Advance Search</a>
                </div>
            </div>


        </div>

    </div>

    <div class="card-body">
        <div class="row">
            <div class="col-md-2">
                <div class="callout callout-info">
                    <label class="control-label" style="color: #FF5722;">TBP Duyệt</label><br>
                    <label><input type="radio" class="flat-green" id="tbpduyet" name="tbpduyet" value="null" checked />Tất cả</label><br>
                    <label><input type="radio" class="flat-green" id="tbpduyet" name="tbpduyet" value="true" />Đã duyệt</label><br>
                    <label><input type="radio" class="flat-green" id="tbpduyet" name="tbpduyet" value="false" />chưa duyệt</label><br>
                </div>
            </div>
            <div class="col-md-2">
                <div class="callout callout-info">
                    <label class="control-label" style="color: #FF5722;">PGD Duyệt</label><br>
                    <label><input type="radio" class="flat-green" id="pgdduyet" name="pgdduyet" value="null" checked />Tất cả</label><br>
                    <label><input type="radio" class="flat-green" id="pgdduyet" name="pgdduyet" value="true" />Đã duyệt</label><br>
                    <label><input type="radio" class="flat-green" id="pgdduyet" name="pgdduyet" value="false" />chưa duyệt</label><br>
                </div>
            </div>
            <div class="col-md-2">
                <div class="callout callout-info">
                    <label class="control-label" style="color: #FF5722;">GĐ Duyệt Mua</label><br>
                    <label><input type="radio" class="flat-green" id="gdduyet" name="gdduyet" value="null" checked />Tất cả</label><br>
                    <label><input type="radio" class="flat-green" id="gdduyet" name="gdduyet" value="true" />Đã duyệt</label><br>
                    <label><input type="radio" class="flat-green" id="gdduyet" name="gdduyet" value="false" />chưa duyệt</label><br>
                </div>
            </div>
            <div class="col-md-2">
                <div class="callout callout-info">
                    <label class="control-label" style="color: #FF5722;">Mua Hàng Duyệt</label><br>
                    <label><input type="radio" class="flat-green" id="mhduyet" name="mhduyet" value="null" checked />Tất cả</label><br>
                    <label><input type="radio" class="flat-green" id="mhduyet" name="mhduyet" value="true" />Đã duyệt</label><br>
                    <label><input type="radio" class="flat-green" id="mhduyet" name="mhduyet" value="false" />chưa duyệt</label><br>
                </div>
            </div>
            <div class="col-md-2">
                <div class="callout callout-info">
                    <label class="control-label" style="color: #FF5722;">GĐ Duyệt Giá</label><br>
                    <label><input type="radio" class="flat-green" id="gdduyetg" name="gdduyetg" value="null" checked />Tất cả</label><br>
                    <label><input type="radio" class="flat-green" id="gdduyetg" name="gdduyetg" value="true" />Đã duyệt</label><br>
                    <label><input type="radio" class="flat-green" id="gdduyetg" name="gdduyetg" value="false" />chưa duyệt</label><br>
                </div>
            </div>
            <div class="col-md-2">
                <div class="callout callout-info">
                    <label class="control-label" style="color: #FF5722;">Thời gian tạo</label>
                    <div class="bootstrap-timepicker">
                        <div class="form-group">
                            <div class="input-group">
                                <label>Từ:</label><input type="text" id="ngay1" name="ngay1" class="time1 form-control" readonly="readonly" value="@DateTime.Now.AddMonths(-2).ToShortDateString()"><br>
                                <div class="input-group-append">
                                    <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bootstrap-timepicker">
                        <div class="form-group">
                            <div class="input-group">
                                <label>Đến:</label> <input type="text" id="ngay2" name="ngay2" class="time1 form-control" readonly="readonly"><br>
                                <div class="input-group-append">
                                    <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div class="callout callout-info">
                    <label class="control-label" style="color: #FF5722;">Từ khóa</label><br>
                    <input type="text" class="form-control" id="searchString" name="searchString" placeholder="Số Phiếu Yêu Cầu,tên người tạo, phòng ban, lý do...." />

                </div>
            </div>
            <div class="col-md-12 text-center">
                <div class="form-group">
                    <a class="btn btn-primary" id="inbaocao">Tìm kiếm</a>
                </div>
            </div>
        </div>
        <script src="~/Scripts/jquery-1.9.1.min.js"></script>
        <script>
            $(document).ready(function () {
                var tbpduyet = $("input[name=tbpduyet]:checked").val();
                var pgdduyet = $("input[name=pgdduyet]:checked").val();
                var gdduyet = $("input[name=gdduyet]:checked").val();
                var mhduyet = $("input[name=mhduyet]:checked").val();
                var gdduyetg = $("input[name=gdduyetg]:checked").val();
                var ngay1 = $('#ngay1').val();
                var ngay2 = $('#ngay2').val();
                var searchString = $('#searchString').val();
                $('#inbaocao').attr("href", '/ProposalToBuy/SearchAdvance1?tbpduyet=' + tbpduyet + '&pgdduyet=' + pgdduyet + '&gdduyet=' + gdduyet + '&mhduyet=' + mhduyet + '&gdduyetg=' + gdduyetg + '&ngay1=' + ngay1 + '&ngay2=' + ngay2 + '&searchString=' + searchString);

                $("#inbaocao").focus(function () {
                    var tbpduyet = $("input[name=tbpduyet]:checked").val();
                    var pgdduyet = $("input[name=pgdduyet]:checked").val();
                    var gdduyet = $("input[name=gdduyet]:checked").val();
                    var mhduyet = $("input[name=mhduyet]:checked").val();
                    var gdduyetg = $("input[name=gdduyetg]:checked").val();
                    var ngay1 = $('#ngay1').val();
                    var ngay2 = $('#ngay2').val();
                    var searchString = $('#searchString').val();
                    $('#inbaocao').attr("href", '/ProposalToBuy/SearchAdvance1?tbpduyet=' + tbpduyet + '&pgdduyet=' + pgdduyet + '&gdduyet=' + gdduyet + '&mhduyet=' + mhduyet + '&gdduyetg=' + gdduyetg + '&ngay1=' + ngay1 + '&ngay2=' + ngay2 + '&searchString=' + searchString);

                });
            });

        </script>
    </div>
    <div class="card-footer">

    </div>

</div>
<div class="row">
    <div class="col-md-12">
        <div class="card card-success card-outline">
            <div class="card-header">
                <h3 class="card-title"><i class="fa fa-clipboard"></i> Kết quả</h3>


            </div>
            <div class="card-body">
            


                <ul class="todo-list">
                    @if (Model != null)
                    {
                        foreach (var item in Model)
                        {

                            <li>
                                @if (item.BOSSApproval == false)
                                {
                                    if (item.Status == true)
                                    {
                                        if (item.Type == "new")
                                        {

                                            if (item.BOSSApproval1 == true)
                                            {

                                                <a href="/ProposalToBuy/Edit1/@item.ID"><span class="text">@item.Reason</span></a>


                                            }
                                            else
                                            {
                                                <a href="/ProposalToBuy/Edit2/@item.ID"><span class="text">@item.Reason</span></a>
                                            }
                                        }
                                        else
                                        { <a href="/ProposalToBuy/Edit/@item.ID"><span class="text">@item.Reason</span></a>}
                                }
                                else
                                {
                                    <a href="/ProposalToBuy/View/@item.ID"> <span class="text" style="color:red"><del>@item.Reason</del> </span>(phiếu đã bị xóa)</a>
                                }

                            }
                            else
                            {
                                <a href="/ProposalToBuy/View/@item.ID"><span class="text">@item.Reason</span></a>
                            }

                                <a class="btn btn-app float-right" style="min-width: 30px; height: 30px; padding: 5px 5px; border: none; margin-left: 8px; margin-right: 8px; ">
                                    <span class="badge bg-warning">Giám Đốc</span>
                                    @Html.Raw(item.BOSSApproval ? "<span class='fa fa-check-circle-o fa-2x' style='color: #0cb583;font-size: 30px;'></span>" : "<span class='fa fa-times-circle-o fa-2x' style='color: #f90d0d;font-size: 30px;'></span>")
                                </a>
                                <a class="btn btn-app float-right" style="min-width: 30px; height: 30px; padding: 5px 5px; border: none; margin-left: 8px; margin-right: 8px; ">
                                    <span class="badge bg-warning">Mua Hàng</span>
                                    @Html.Raw(item.PDApproval ? "<span class='fa fa-check-circle-o fa-2x' style='color: #0cb583;font-size: 30px;'></span>" : "<span class='fa fa-times-circle-o fa-2x' style='color: #f90d0d;font-size: 30px;'></span>")
                                </a>
                                <a class="btn btn-app float-right" style="min-width: 30px; height: 30px; padding: 5px 5px; border: none; margin-left: 8px; margin-right: 8px; ">
                                    <span class="badge bg-warning">Giám Đốc</span>
                                    @Html.Raw(item.BOSSApproval1 ? "<span class='fa fa-check-circle-o fa-2x' style='color: #0cb583;font-size: 30px;'></span>" : "<span class='fa fa-times-circle-o fa-2x' style='color: #f90d0d;font-size: 30px;'></span>")
                                </a>
                                @if (item.Sep1 != "cuong.tong")
                                {
                                    <a class="btn btn-app float-right" style="min-width: 30px; height: 30px; padding: 5px 5px; border: none; margin-left: 8px; margin-right: 8px;">
                                        <span class="badge bg-warning">BGĐ</span>
                                        @Html.Raw(item.BGDApproval ? "<span class='fa fa-check-circle-o fa-2x' style='color: #0cb583;font-size: 30px;'></span>" : "<span class='fa fa-times-circle-o fa-2x' style='color: #f90d0d;font-size: 30px;'></span>")
                                    </a>

                                }
                                <a class="btn btn-app float-right" style="min-width: 30px; height: 30px; padding: 5px 5px; border: none; margin-left: 8px; margin-right: 8px; ">
                                    <span class="badge bg-warning">TBP</span>
                                    @Html.Raw(item.HODApproval ? "<span class='fa fa-check-circle-o fa-2x' style='color: #0cb583;font-size: 30px;'></span>" : "<span class='fa fa-times-circle-o fa-2x' style='color: #f90d0d;font-size: 30px;'></span>")
                                </a>

                                <br />
                                <span> <a href="/ProposalToBuy/EditA1/@item.ID"><span style="color:black">(<i class="fa fa-money" aria-hidden="true" style="font-size: 22px;color: #28a745;"></i> Số: @item.ID)</span></a></span>
                                <span class="badge badge-info"><i class="fa fa-user"></i> @item.FullName </span><span class="badge badge-warning"><i class="fa fa-briefcase"></i> @item.Department </span>
                                <span class="badge badge-info"><i class="fa fa-clock-o"></i> @item.CreateDate.ToString("dd/MM/yyyy") </span>
                                @{count = count + 1;}
                            </li>

                        }
                    }
                    else
                    {
                        <li>chưa có kết quả nào</li>
                    }
                </ul>
            </div>
            <div class="card-footer clearfix">
                @if (Model != null)
                {
                    <div class="dataTables_paginate paging_simple_numbers float-right" id="example2_paginate">
                        @Html.PagedListPager(Model, page => Url.Action("SearchAdvance1", new { @tbpduyet=ViewBag.tbpduyet, @pgdduyet = ViewBag.pgdduyet, @gdduyet = ViewBag.gdduyet, @mhduyet = ViewBag.mhduyet, @gdduyetg = ViewBag.gdduyetg, @ngay1 = ViewBag.ngay1, @ngay2 = ViewBag.ngay2, @searchString = @ViewBag.SearchString,page }))
                    </div>
                }
                </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $("#sokq").text(@count);

                });

</script>





