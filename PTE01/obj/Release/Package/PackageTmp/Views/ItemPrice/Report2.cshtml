@{
    ViewBag.Title = "Report1";
    Layout = "~/Views/Shared/_Theme3.cshtml";
    List<Model.View.Report7> dsItem = ViewBag.dsItem;
    List<Model.View.Dropdownlist2> dropList = ViewBag.dropList;
    string[] ds1 = ViewBag.ds1;
    double curPrice = 0;
}
<div class="row">
    <div class="col-md-12">
        <div class="card card-success card-outline">
            <div class="card-header">
                <h3 class="card-title"><i class="fa fa-clipboard"></i>Giá Vật Tư</h3>

                <div class="card-tools">
                    <div class="btn-group" style="height:40px">
                        <button type="button" class="btn btn-success btn-sm dropdown-toggle" data-toggle="dropdown">
                            <i class="fa fa-file-excel-o"></i>
                        </button>
                        <div class="dropdown-menu float-right" role="menu">
                            <a class="dropdown-item" href="/ItemPrice/Report1?year=@DateTime.Now.Year">Report Giá Vật Tư XI MẠ</a>
                            <a class="dropdown-item" href="/ItemPrice/Report2?year=@DateTime.Now.Year">Report Giá Vật Tư ÉP NHỰA</a>
                        </div>
                    </div>
                    <div style="float:left">
                        @using (Html.BeginForm("Report2", "ItemPrice", FormMethod.Get))
                        {
                            <div class="input-group " style="width: 120px;">
                                <input type="number" value="@ViewBag.year" name="year" max="@DateTime.Now.Year" min="2019" step="1" class="form-control float-right" style="background: #e6c5c8; font-weight: bold;">
                                <div class="input-group-append">
                                    <button type="submit" class="btn btn-default"><i class="fa fa-search"></i></button>
                                </div>
                            </div>
                        }
                    </div>

                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
                        <thead style=" background: #17a2b8; font-weight: bold;">
                            <tr>
                                <td>Item</td>
                                <td>@(ViewBag.year - 1)</td>
                                <td>T1</td>
                                <td>T2</td>
                                <td>T3</td>
                                <td>T4</td>
                                <td>T5</td>
                                <td>T6</td>
                                <td>T7</td>
                                <td>T8</td>
                                <td>T9</td>
                                <td>T10</td>
                                <td>T11</td>
                                <td>T12</td>
                            </tr>
                        </thead>
                        <tbody>
                            @for (int d = 0; d < ds1.Length; d++)
                            {
                                <tr>
                                    <td style="background: antiquewhite;">
                                        <span style="font-size:12px; font-weight:bold;"> @ds1[d]</span>
                                        @foreach (var temp in dropList)
                                        {
                                            if (temp.ID == ds1[d])
                                            { <span>@temp.Name</span>}
                                        }
                                    </td>
                                    @{ curPrice = 0; }
                                    @foreach (var item in dsItem)
                                    {

                                        if (item.Name == ds1[d] && item.Name2 == (ViewBag.year - 1).ToString())
                                        {

                                            <td>@item.Value1.ToString("N0").Replace(',', '.')</td>

                                            if (item.Value1 > 0)
                                            { curPrice = item.Value1; }
                                        }
                                    }

                                    @for (int i = 1; i <= 12; i++)
                                    {
                                        foreach (var item in dsItem)
                                        {
                                            string tam = "T" + i;
                                            if (item.Name == ds1[d] && item.Name2 == tam)
                                            {
                                                if (item.Value1 == curPrice || curPrice == 0 || item.Value1 == 0)
                                                {
                                                    <td>@item.Value1.ToString("N0").Replace(',', '.')</td>
                                                }
                                                else
                                                {
                                                    if (item.Value1 < curPrice)
                                                    {
                                                        <td style="color: green; font-weight: bold; font-size: 18px;"><i class="fa fa-arrow-down" aria-hidden="true"></i> @item.Value1.ToString("N0").Replace(',', '.')</td>
                                                    }
                                                    else
                                                    {
                                                        <td style="color: red; font-weight: bold; font-size: 18px; "><i class="fa fa-arrow-up" aria-hidden="true"></i> @item.Value1.ToString("N0").Replace(',', '.')</td>}

                                                }
                                                if (item.Value1 > 0)
                                                { curPrice = item.Value1; }

                                            }
                                        }
                                    }

                                </tr>
                            }

                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-footer clearfix">

            </div>

        </div>

    </div>
</div>
