@model List<Model.View.TaskView1>
@{
    ViewBag.Title = "Report";
    Layout = "~/Views/Shared/_Theme3.cshtml";

    string itMe = (string)ViewBag.itMe;
    IEnumerable<Model.View.UserView2> lInferior = ViewBag.lInferior;
    DateTime dauthang = DateTime.Now.AddDays(-DateTime.Now.Day +1);

}
@section jsFooter
{

    <script src="/Assets/theme3/plugins/timepicker/bootstrap-timepicker.min.js"></script>
    <script>
        $(function () {
            $("#ngay1").datepicker();
            $("#ngay2").datepicker();
            $('input[type="checkbox"].flat-green, input[type="radio"].flat-green').iCheck({
                checkboxClass: 'icheckbox_flat-green',
                radioClass: 'iradio_flat-green'
            })
            $('.select2').select2()
        })
    </script>
}
<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<link href="~/Assets/js/jquery-ui.css" rel="stylesheet" />
<div class="card card-primary">
    <div class="card-header">
        <h3 class="card-title">Tìm kiếm nâng cao</h3>
    </div>

    <div class="card-body">
        <div class="row">
            <div class="col-md-4">
                <div class="callout callout-info">
                    <label class="control-label" style="color: #FF5722;">Chọn nhân viên</label><br>
                    <select class="form-control select2" style="width: 100%;" id="username">
                        <option value="@itMe">Chính Tôi</option>
                        @foreach (var item in lInferior)
                        {
                            <option value="@item.UserName">@item.FullName</option>
                        }

                    </select>

                </div>
            </div>
            <div class="col-md-4">
                <div class="callout callout-info">
                    <label class="control-label" style="color: #FF5722;">Tình trạng</label><br>
                    <select class="form-control" style="width: 100%;" id="status">
                        <option value="null">Tất cả</option>
                        <option value="0">Chưa xong + trễ Deadline</option>
                        <option value="1">Chưa xong + chưa đến Deadline</option>
                        <option value="2">Đã xong + trễ Deadline</option>
                        <option value="3">Đã xong + đúng Deadline</option>
                        <option value="-1">Nhiện vụ bị hủy</option>
                        <option value="-2">Nhiện vụ bị từ chối</option>
                    </select>                    
                </div>
            </div>
 
            <div class="col-md-4">
                <div class="callout callout-info">
                    <label class="control-label" style="color: #FF5722;">Thời gian deadline</label>
                    <div class="bootstrap-timepicker">
                        <div class="form-group">
                            <div class="input-group">
                                <label>Từ:</label><input type="text" id="ngay1" name="ngay1" class="time1 form-control" readonly="readonly" value="@dauthang.ToShortDateString()"><br>
                                <div class="input-group-append">
                                    <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bootstrap-timepicker">
                        <div class="form-group">
                            <div class="input-group">
                                <label>Đến:</label> <input type="text" id="ngay2" name="ngay2" class="time1 form-control" readonly="readonly"><br>
                                <div class="input-group-append">
                                    <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>   
            <div class="col-md-12 text-center">
                <div class="form-group">
                    <a class="btn btn-primary" id="inbaocao">Tìm kiếm</a><a class="btn btn-warning" id="inbaocao2">In báo cáo</a>
                </div>
            </div>
        </div>
        <script src="~/Scripts/jquery-1.9.1.min.js"></script>
        <script>
            $(document).ready(function () {
                var username = $("#username").val();
                var status = $("#status").val();
                var ngay1 = $('#ngay1').val();
                var ngay2 = $('#ngay2').val();
                $('#inbaocao').attr("href", '/Task/Report?username=' + username + '&status=' + status + '&ngay1=' + ngay1 + '&ngay2=' + ngay2 );
             

                $("#inbaocao").click(function () {
                    var username = $("#username").val();
                    var status = $("#status").val();
                    var ngay1 = $('#ngay1').val();
                    var ngay2 = $('#ngay2').val();
                    $('#inbaocao').attr("href", '/Task/Report?username=' + username + '&status=' + status + '&ngay1=' + ngay1 + '&ngay2=' + ngay2);                 

                });
                $("#inbaocao2").click(function () {
                    var username = $("#username").val();
                    var status = $("#status").val();
                    var ngay1 = $('#ngay1').val();
                    var ngay2 = $('#ngay2').val();
                    $('#inbaocao2').attr("href", '/Task/Report1?username=' + username + '&status=' + status + '&ngay1=' + ngay1 + '&ngay2=' + ngay2);

                });
            });

        </script>
    </div>
    <div class="card-footer">

    </div>

</div>

<div class="row">
    <div class="col-md-12">
        <div class="card card-success card-outline">
            <div class="card-header">
                <h3 class="card-title"><i class="fa fa-clipboard"></i> <span id="sokq" style="color:red;font-weight:bold;"></span> Kết quả</h3>
            </div>
            <div class="card-body">
                <ul class="todo-list">
                    <li>
                        <a href="/Task/Create" data-toggle="tooltip" title="Thêm nhiệm vụ mới ">Thêm nhiệm vụ mới<i class="fa fa-plus-circle" style="font-size: 20px; color: red"></i></a>

                    </li>
                    @if(Model !=null)
                    {
                       foreach(var item in Model)
                       {
                             @MyHelper.ViewTaskinTask(item, null)
                       }                             

                    }
                    else
                    {
                        <li>chưa có kết quả nào</li>
                    }
                   
                </ul>
            </div>
            <div class="card-footer clearfix">
                <a class="btn btn-sm btn-info float-left" href="/Task/Create"><i class="fa fa-plus"></i> Thêm mới</a>
            </div>
        </div>
    </div>
</div>


