@model Model.EF.Task

@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Shared/_Theme3.cshtml";
    var listU = (IEnumerable<Model.View.UserView2>)ViewBag.listUser;
    string nguoitao = ViewBag.nguoitao;
    var nguoinhan = new List<SelectListItem>();
    nguoinhan.Add(new SelectListItem
    {
        Text = "Chọn Người Thực Hiện",
        Value = "none",
        Selected = true
    });
    foreach (var item in listU)
    {
        if (item.FullName == nguoitao)
        {
            nguoinhan.Add(new SelectListItem
            {
                Text = item.FullName,
                Value = item.UserName,
                Selected=true,
            });
        }
        else
        {
            nguoinhan.Add(new SelectListItem
            {
                Text = item.FullName,
                Value = item.UserName,
            });
        }
    }
    List<SelectListItem> vonglap = new List<SelectListItem>();
    vonglap.Add(new SelectListItem
         {
             Text = "không lặp lại",
             Value = "0",
             Selected = true
         });
    vonglap.Add(new SelectListItem
         {
             Text = "lặp lại 30 ngày",
             Value = "D30",
         });
    vonglap.Add(new SelectListItem
    {
        Text = "lặp lại 4 tuần",
        Value = "W04",
    });
    vonglap.Add(new SelectListItem
    {
        Text = "lặp lại 12 tháng",
        Value = "M12",
    });

    List<SelectListItem> loai = new List<SelectListItem>();
    loai.Add(new SelectListItem
    {
        Text = "Định kỳ",
        Value = "0",
        Selected = true
    });
    loai.Add(new SelectListItem
    {
        Text = "Phát sinh",
        Value = "1",
    });
    List<SelectListItem> danhgia = new List<SelectListItem>();
    danhgia.Add(new SelectListItem
    {
        Text = "Đạt yêu cầu (3 điểm)",
        Value = "3",
        Selected = true
    });
    danhgia.Add(new SelectListItem
    {
        Text = "Cần cố gắng (2 điểm)",
        Value = "2",
    });
    danhgia.Add(new SelectListItem
    {
        Text = "Không đạt (1 điểm)",
        Value = "1",
    });
    danhgia.Add(new SelectListItem
    {
        Text = "Vượt yêu cầu (4 điểm)",
        Value = "4",
    });
    List<SelectListItem> tytrong = new List<SelectListItem>();
    tytrong.Add(new SelectListItem
    {
        Text = "(1 điểm)không Quan trọng và không gấp",
        Value = "1",
        Selected = true
    });
    tytrong.Add(new SelectListItem
    {
        Text = "(2 điểm)Quan trọng hoặc Cần gấp",
        Value = "2",
    });
    tytrong.Add(new SelectListItem
    {
        Text = "(3 điểm)Quan trọng và Cần gấp",
        Value = "3",
    });   
    
}
@section jsFooter
{
<script src="/Assets/plugin/ckfinder/ckfinder.js"></script>
<script src="/Assets/theme3/plugins/datepicker/js/bootstrap-datetimepicker.js"></script>
    <script src="/Assets/theme3/plugins/datepicker/js/locales/bootstrap-datetimepicker.fr.js" charset="UTF-8"></script>
    <script>
        $(function () {
            $('.form_datetime').datetimepicker({
                format: 'mm/dd/yyyy hh:ii',
                todayBtn: 1,
                autoclose: 1,
                todayHighlight: 1,
            });
            $('.select2').select2()

        })
    </script>

}
<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<div class="card card-primary">
    <div class="card-header">
        <h3 class="card-title">Tạo Nhiệm Vụ Mới</h3>
    </div>
    @using (Html.BeginForm("Create", "Task", FormMethod.Post))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="card-body">
            <div class="row">
                <div class="col-md-8">
                    <div class="form-group">
                        <label class="control-label col-md-12">Tên Công Việc<span style="font-weight:bold;color:red">*</span></label>
                        @Html.TextBoxFor(model => model.Subject, new { @class = "form-control" })
                    </div>
                </div>
                <div class='col-md-4 col-6'>
                    <label class="control-label">Tỷ trọng</label>
                    @Html.DropDownListFor(model => model.Proportion, tytrong, new { @class = "form-control", })
                </div>
                @*<div class='col-md-1 col-6'>
                    <label class="control-label">Loại</label>
                    @Html.DropDownListFor(model => model.Type, loai, new { @class = "form-control", })

                </div>*@
                <div class="col-md-6">
                    <div class="form-group">
                        <label class="control-label col-md-12">Owner<span style="font-weight:bold;color:red">*</span></label>
                        @Html.DropDownListFor(model => model.Owner, nguoinhan, new { @class = "form-control select2", @style = "width: 100%;" })
                    </div>
                </div>
                <div class='col-md-2'>
                    <label class="control-label">Lặp định kỳ</label>
                    @Html.DropDownListFor(model => model.LogDL, vonglap, new { @class = "form-control", })

                </div>
               
                <div class="col-md-2">
                    <div class="form-group">
                        <label>Bắt đầu:</label>
                        <div class="input-group date form_datetime" data-link-field="StartDate">
                            <input class="form-control" type="text" value="" readonly>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-th"></span></span>
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                            </div>
                        </div>
                        <input type="hidden" id="StartDate" name="StartDate" value="" /><br />
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="form-group">
                        <label>Deadline<span style="font-weight:bold;color:red">*</span>:</label>
                        <div class="input-group date form_datetime" data-link-field="Deadline">
                            <input class="form-control" type="text" value="" readonly>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
                            <span class="input-group-addon"><span class="glyphicon glyphicon-th"></span></span>
                            <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fa fa-calendar"></i></span>
                            </div>
                        </div>
                        <input type="hidden" id="Deadline" name="Deadline" value="" /><br />
                    </div>
                </div>
                <div class='col-md-6'>
                    <label class="control-label">Đính kèm file</label>
                    <div class='input-group'>
                        @Html.TextBoxFor(model => model.File1, new { @class = "form-control", @style = "background: #c2c7d0;", @placeholder = "chọn file..."})
                        <div class=" input-group-append">
                            <span class="input-group-text">
                                <a id="btnSelectFile" href="#"><span class="fa fa-file"></span></a>
                            </span>
                        </div>
                    </div>
                </div>
                <script>
                    $('#btnSelectFile').on('click', function (e) {
                        e.preventDefault();
                        var finder = new CKFinder();
                        finder.selectActionFunction = function (url) {
                            $('#File1').val(url);
                            $('#btnViewFile').attr("href", $('#File1').val());
                        };
                        finder.popup();
                    })
                </script>
                <div class="col-md-12">
                    <div class="form-group">
                        <label class="control-label col-md-12">Diễn giải chi tiết</label>
                        @Html.TextAreaFor(model => model.Description, new { @class = "form-control", @rows = "8" })
                    </div>
                </div>
            </div>
        </div>
        <div class="card-footer">
            <button type="submit" class="btn btn-primary" onclick="openNav()">Lưu thông tin</button>
        </div>
    }
</div>
@*<span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776; open</span>*@






