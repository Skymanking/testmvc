@model PagedList.IPagedList<Model.View.FixRequest1>
@using PagedList.Mvc;
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Theme3.cshtml";
    var userLogin = (string)ViewBag.userName;
}
@section jsFooter
{
    <script src="/Scripts/ChangeCompletedFixRequest.js"></script>
}


<div class="row">
    <div class="col-md-12">
        <div class="card card-success card-outline">
            <div class="card-header">
                <h3 class="card-title"><i class="fa fa-clipboard"></i>YC Sửa Chữa</h3>

                <div class="card-tools">
                    @using (Html.BeginForm("Index", "FixRequest", FormMethod.Get))
                    {
                        <div class="input-group " style="width: 300px;">
                            <input type="text" value="@ViewBag.SearchString" name="searchString" class="form-control float-right" placeholder="tìm kiếm">
                            <div class="input-group-append">
                                <button type="submit" class="btn btn-default"><i class="fa fa-search"></i></button>
                            </div>
                        </div>
                    }
                </div>
            </div>
            <div class="card-body">
                <ul class="todo-list">
                    <li>
                        <a href="/FixRequest/Create">Thêm yêu cầu mới<i class="fa fa-plus-circle" style="font-size: 20px; color: red"></i></a>
                    </li>
                    @foreach (var item in Model)
                    {
                        if (item.Completed == true)
                        {
                            <li style="background: #d3fbdc;">
                                <span><i class="fa fa-wrench text-warning"></i> </span>
                                @if (item.Status == false)
                                {
                                   <span class="text" style="color:red"><del><a href="/FixRequest/Edit/@item.ID">@item.DeviceName</a></del>(phiếu đã hủy)</span>
                                }
                                else
                                {
                                    if (item.Finished == true)
                                    {<span class="text"><del><a href="/FixRequest/Edit/@item.ID" style="color:black">@item.DeviceName</a></del></span>}
                                    else
                                    {<a href="/FixRequest/Edit/@item.ID"><span class="text">@item.DeviceName</span></a>}
                                }

                                @if (@item.Deadline != null)
                                {
                                    if (item.CompletedDate != null)
                                    {
                                        if (item.CompletedDate > item.Deadline)
                                        {
                                            <span class="badge badge-danger"><i class="fa fa-clock-o"></i> Deadline: @item.Deadline.Value.ToString("dd/MM/yyyy hh:mm") </span>
                                        }
                                        else
                                        {<span class="badge badge-success"><i class="fa fa-clock-o"></i> Deadline: @item.Deadline.Value.ToString("dd/MM/yyyy hh:mm") </span>

                                        }
                                    }
                                    else
                                    {
                                        if (DateTime.Now > item.Deadline)
                                        { <span class="badge badge-danger"><i class="fa fa-clock-o"></i> Deadline: @item.Deadline.Value.ToString("dd/MM/yyyy hh:mm") </span>}
                                        else
                                        {<span class="badge badge-warning"><i class="fa fa-clock-o"></i> Deadline: @item.Deadline.Value.ToString("dd/MM/yyyy hh:mm") </span> }
                                    }

                                }
                                @if (item.CompletedDate != null)
                                {     <span class="badge badge-dark"><i class="fa fa-clock-o"></i> Hoàn thành: @item.CompletedDate.Value.ToString("dd/MM/yyyy hh:mm") </span>}
                                <span class="float-right">
                                    <span class="float-right">@Html.Raw(item.Finished ? "<span class='fa fa-check fa-2x' style='color: #0cb583;width: 30px;'></span>" : "<span class='fa fa-times fa-2x' style='color: #f90d0d;width: 30px;'></span>")</span>
                                    <span class="float-right">@Html.Raw(item.Completed ? "<span class='fa fa-check fa-2x' style='color: #0cb583;width: 30px;'></span>" : "<span class='fa fa-times fa-2x' style='color: #f90d0d;width: 30px;'></span>")</span>
                                    <span class="float-right">@Html.Raw(item.HODApproval ? "<span class='fa fa-check fa-2x' style='color: #0cb583;width: 30px;'></span>" : "<span class='fa fa-times fa-2x' style='color: #f90d0d;width: 30px;'></span>")</span>
                                    <br />
                                    <span class="float-right badge badge-dark"><i class="fa fa-key"></i> @item.Receiver </span>
                                    <span class="float-right badge badge-warning"><i class="fa fa-wrench"></i> @item.Fixer  </span>
                                </span>
                                <br />
                                <span> ( Số phiếu: @item.ID )</span>
                                <span class="badge badge-info"><i class="fa fa-user"></i> @item.CreateBy </span>
                                <span class="badge badge-info"><i class="fa fa-plus"></i> @item.CreateDate.ToString("dd/MM/yyyy") </span>
                            </li>
                        }
                        else
                        {
                            <li>
                                <span><i class="fa fa-wrench text-warning"></i> </span>
                                @if (item.Status == false)
                                {
                                    <span class="text" style="color:red"><del><a href="/FixRequest/Edit/@item.ID">@item.DeviceName</a></del>(phiếu đã hủy)</span>
                                }
                                else
                                {
                                    if (item.Finished == true)
                                    {<span class="text"><del><a href="/FixRequest/Edit/@item.ID" style="color:black">@item.DeviceName</a></del></span>}
                                    else
                                    {<a href="/FixRequest/Edit/@item.ID"><span class="text">@item.DeviceName</span></a>}
                                }
                                @if (@item.Deadline != null)
                                {
                                    if (item.CompletedDate != null)
                                    {
                                        if (item.CompletedDate > item.Deadline)
                                        {
                                            <span class="badge badge-danger"><i class="fa fa-clock-o"></i> Deadline: @item.Deadline.Value.ToString("dd/MM/yyyy hh:mm") </span>
                                        }
                                        else
                                        {<span class="badge badge-success"><i class="fa fa-clock-o"></i> Deadline: @item.Deadline.Value.ToString("dd/MM/yyyy hh:mm") </span>
                                        }
                                    }
                                    else
                                    {
                                        if (DateTime.Now > item.Deadline)
                                        { <span class="badge badge-danger"><i class="fa fa-clock-o"></i> Deadline: @item.Deadline.Value.ToString("dd/MM/yyyy hh:mm") </span>}
                                        else
                                        {<span class="badge badge-warning"><i class="fa fa-clock-o"></i> Deadline: @item.Deadline.Value.ToString("dd/MM/yyyy hh:mm") </span> }
                                    }

                                }
                                @if (item.CompletedDate != null)
                                {     <span class="badge badge-dark"><i class="fa fa-clock-o"></i> Hoàn thành: @item.CompletedDate.Value.ToString("dd/MM/yyyy hh:mm") </span>}
                                <span class="float-right">
                                    <span class="float-right">@Html.Raw(item.Finished ? "<span class='fa fa-check fa-2x' style='color: #0cb583;width: 30px;'></span>" : "<span class='fa fa-times fa-2x' style='color: #f90d0d;width: 30px;'></span>")</span>
                                    <span class="float-right">@Html.Raw(item.Completed ? "<span class='fa fa-check fa-2x' style='color: #0cb583;width: 30px;'></span>" : "<span class='fa fa-times fa-2x' style='color: #f90d0d;width: 30px;'></span>")</span>
                                    <span class="float-right">@Html.Raw(item.HODApproval ? "<span class='fa fa-check fa-2x' style='color: #0cb583;width: 30px;'></span>" : "<span class='fa fa-times fa-2x' style='color: #f90d0d;width: 30px;'></span>")</span>
                                    <br />
                                    <span class="float-right badge badge-dark"><i class="fa fa-key"></i> @item.Receiver </span>
                                    <span class="float-right badge badge-warning"><i class="fa fa-wrench"></i> @item.Fixer  </span>
                                </span>
                                <br />
                                <span> ( Số phiếu: @item.ID )</span>
                                <span class="badge badge-info"><i class="fa fa-user"></i> @item.CreateBy </span>
                                <span class="badge badge-info"><i class="fa fa-plus"></i> @item.CreateDate.ToString("dd/MM/yyyy") </span>
                            </li>
                        }
                    }

                </ul>
            </div>
            <div class="card-footer clearfix">
                <a class="btn btn-sm btn-info float-left" href="/FixRequest/Create"><i class="fa fa-plus"></i> Thêm mới</a>
                <div class="dataTables_paginate paging_simple_numbers float-right" id="example2_paginate">
                    @Html.PagedListPager(Model, page => Url.Action("Index", new { page, @searchString = @ViewBag.SearchString }))
                </div>
            </div>
        </div>
    </div>
</div>
