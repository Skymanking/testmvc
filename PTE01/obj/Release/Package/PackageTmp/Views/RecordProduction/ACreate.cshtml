@model Model.View.FullRecPro
@{
    ViewBag.Title = "ACreate";
    Layout = "~/Views/Shared/_Theme2.cshtml";
    var plan = (Model.EF.Planing)ViewBag.plan;
    var ngmode = (List<Model.EF.NGMode>)ViewBag.ngmode;
    var infoplan = (List<Model.View.RecordPro3>)ViewBag.infoplan;
    var lstep = (List<Model.EF.StepProduction>)ViewBag.lstep;
    var lcongdoan = new List<SelectListItem>();
    foreach(var item in lstep)
    { 
        lcongdoan.Add(new SelectListItem
        {
            Text = item.Name,
            Value = item.ID,
            Selected = true
        });
    }
    string temp = "";
}

<script src="~/Scripts/jquery-3.4.1.min.js"></script>

<div class="card card-primary">
    <div class="card-header">
        <h3 class="card-title">Ghi nhận kết quả SX : @plan.ItemID</h3>
        <div class="card-tools">
            <div class="btn-group" style="height:40px">
                <button type="button" class="btn btn-success btn-sm dropdown-toggle" data-toggle="dropdown">
                    More
                </button>
                <div class="dropdown-menu float-right" role="menu">
                    <a class="dropdown-item" href="/RecordProduction/AIndex2" style="color:#000">Ghi nhận kết quả SX</a>
                    <a class="dropdown-item" href="/RecordProduction/AIndex3" style="color:#000">Ghi nhận kết quả SX có NG</a>

                </div>
            </div>
        </div>
    </div>
    @using (Html.BeginForm("Create1", "RecordProduction", FormMethod.Post))
    {
        @Html.AntiForgeryToken()

        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="card-body">

            <div class="row">
                <div class="col-md-6">
                    <div class='col-md-12'>
                        <label class="control-label">Công đoạn</label>
                        @Html.DropDownListFor(model => model.item.StepName,lcongdoan, new { @class = "form-control" })
                    </div>
                    <div class='col-md-12'>
                        <label class="control-label">Số lượng OK</label>
                        @Html.TextBoxFor(model => model.item.SLOK, new { @class = "form-control", @type = "number", @style = "font-size: 80px;background: #a7f3b9;" })
                    </div>
                    <div class='col-md-12'>
                        <label class="control-label">Số lượng NG</label>
                        @Html.TextBoxFor(model => model.item.SLNG, new { @class = "form-control", @type = "number", @style = "font-size: 80px;background: #e6a9af;", @placeholder = "0" })
                    </div>
                    <input id="item_PlanID" name="item.PlanID" type="text" value="@plan.ID" style="display:none">
                    <input id="item_ItemID" name="item.ItemID" type="text" value="@plan.ItemID" style="display:none">
                    <input id="item_PlanID" name="item.LineID" type="text" value="@plan.Line" style="display:none">
                    <div class='col-md-12'>
                        <p></p>
                        <p><b>Lệnh Sản Xuất:</b> @plan.ID</p>
                        <p><b>Mã Sản Phẩm:<span style="color:#00ff90">@plan.ItemID</span></b> </p>
                        <p><b>Số lượng:<span style="color:#00ff90"> @plan.Quantity </span> </b> - Mã Line: @plan.Line</p>
                        <p><b>Người cập nhật kế hoạch:</b> @plan.ModifyBy ( @plan.ModifyDate.ToString("dd/MM/yyyy HH:mm"))</p>
                        <p><b>Sản xuất từ:</b> @plan.StartDate.ToString("dd/MM/yyyy HH:mm") đến @plan.EndDate.ToString("dd/MM/yyyy HH:mm")</p>
                        <p><b>Ghi chú:</b> @plan.Note</p>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Công Đoạn</th>
                                    <th>Tổng SL OK</th>
                                    <th>Tổng SL NG</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in infoplan)
                                {
                                    <tr>
                                        <td>@item.Step</td>
                                        <td>@item.SumOK</td>
                                        <td>@item.SumNG</td>
                                    </tr>
                                }


                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="col-md-6" style="background: #dee2e6;">
                    <h2 style="background: #f5acb3; padding: 10px;">DANH SÁCH LỖI</h2>
                    <div class="row">
                        @if (ngmode != null)
                        {
                            for (int i = 0; i < ngmode.Count; i++)
                            {
                                { temp = "detail_" + i + "__IDMod"; }
                                <div class="col-6" style="padding-top: 15px;">
                                    @Html.TextBoxFor(model => model.detail[i].SLNG, new { @type = "number", @style = "width:150px;padding: 10px;font-size: 24px;", @placeholder = "0" })
                                    <input id="@temp" name="detail[@i].IDMod" type="text" value="@ngmode[i].ID" style="display:none">
                                    <span style="font-size:18px; color:red; font-weight:bold;"> @ngmode[i].Name</span>
                                </div>
                            }
                        }
                    </div>
                </div>
            </div>
        </div>
        <div class="card-footer">
            <button type="submit" class="nutsave btn btn-primary" onclick="openNav()">Lưu thông tin</button>
        </div>

    }
</div>
